!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("html2canvas")):"function"==typeof define&&define.amd?define(["html2canvas"],t):"object"==typeof exports?exports.Canvasot=t(require("html2canvas")):e.Canvasot=t(e.html2canvas)}(window,(function(e){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(i,a,function(t){return e[t]}.bind(null,a));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(t,r){t.exports=e},function(e,t,r){"use strict";r.r(t);var i=r(0),a=r.n(i);function o(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t,this.oRelDiv=document.createElement("div"),this.params={left:0,top:0,width:0,height:0,oldDifX:0,oldDifY:0,currentX:0,currentY:0,flag:!1,kind:"drag"},this.capture=e.initCapture}var t,r,i;return t=e,i=[{key:"initCapture",get:function(){return{x:0,y:0,width:100,height:100}}}],(r=[{key:"ID",value:function(e){return document.getElementById(e)}},{key:"getCss",value:function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,!1)[t]}},{key:"handleCaptrue",value:function(t){this.comfirnCb=t||null;var r=this,i=this.el,a=i.clientHeight,o=i.clientWidth;this.oRelDiv.innerHTML="",this.oRelDiv.style.position="absolute",this.oRelDiv.style.width=o+"px",this.oRelDiv.style.height=a+"px",this.oRelDiv.style.overflow="hidden",this.oRelDiv.style.zIndex="9999999",this.oRelDiv.id="cropContainer",this.elOverflow=r.getCss(this.el.parentElement,"overflow"),this.el.parentElement.style.overflow="hidden",this.oRelDiv.style.top=this.el.offsetTop+"px",this.oRelDiv.style.left=this.el.offsetLeft+"px",this.el.parentElement.insertBefore(this.oRelDiv,this.el);var n=e.initCapture.width,s=e.initCapture.height,p=o/2-n/2,l=a/2-s/2;this.oRelDiv.innerHTML='<div id="zxxCropBox" style="height:'+s+"px; width:"+n+"px; position:absolute; left:"+p+'pxpx; border:1px solid white;box-shadow:rgba(59, 59, 59, 0.7) 0px 0px 0px 2018px;"><div id="zxxDragBg" style="height:100%; background:transparent; opacity:0.3; filter:alpha(opacity=30); cursor:move"></div><div id="dragLeftTop" style="border-radius:50%;position:absolute; width:4px; height:4px; border:1px solid #000; background:white; overflow:hidden; left:-3px; top:-3px; cursor:nw-resize;"></div><div id="dragLeftBot" style="border-radius:50%;position:absolute; width:4px; height:4px; border:1px solid #000; background:white; overflow:hidden; left:-3px; bottom:-3px; cursor:sw-resize;"></div><div id="dragRightTop" style="border-radius:50%;position:absolute; width:4px; height:4px; border:1px solid #000; background:white; overflow:hidden; right:-3px; top:-3px; cursor:ne-resize;"></div><div id="dragRightBot" style="border-radius:50%;position:absolute; width:4px; height:4px; border:1px solid #000; background:white; overflow:hidden; right:-3px; bottom:-3px; cursor:se-resize;"></div><div id="dragTopCenter" style="border-radius:50%;position:absolute; width:4px; height:4px; border:1px solid #000; background:white; overflow:hidden; top:-3px; left:50%; margin-left:-3px; cursor:n-resize;"></div><div id="dragBotCenter" style="border-radius:50%;position:absolute; width:4px; height:4px; border:1px solid #000; background:white; overflow:hidden; bottom:-3px; left:50%; margin-left:-3px; cursor:s-resize;"></div><div id="dragRightCenter" style="border-radius:50%;position:absolute; width:4px; height:4px; border:1px solid #000; background:white; overflow:hidden; right:-3px; top:50%; margin-top:-3px; cursor:e-resize;"></div> <div id="dragLeftCenter" style="border-radius:50%;position:absolute; width:4px; height:4px; border:1px solid #000; background:white; overflow:hidden; left:-3px; top:50%; margin-top:-3px; cursor:w-resize;"></div></div>';var d=document.createElement("div");d.innerHTML='<div id="captureTool" style="min-width:150px;width:100%;text-align:center;position:absolute;z-index:999;top: 10px;left: 50%;transform: translate3d(-50%, 0,0);"><button  id ="cancelCapture" style="border:none;padding:1px 4px;">取消</button><button id="captureAll" style="margin: 0 20px;border:none;padding:1px 4px;">截全部</button><button id="capture" style="border:none;padding:1px 4px;">截图</button></div>',document.body.appendChild(d),document.getElementById("capture").addEventListener("click",this._captureFn.bind(r)),document.getElementById("cancelCapture").addEventListener("click",this._cancelCaptureFn.bind(r)),document.getElementById("captureAll").addEventListener("click",this._captureAll.bind(r));var h=function(e,t,i){r.params.width=r.getCss(t,"width"),r.params.height=r.getCss(t,"height"),"auto"!==r.getCss(t,"left")&&(r.params.left=r.getCss(t,"left")),"auto"!==r.getCss(t,"top")&&(r.params.top=r.getCss(t,"top"));var d=r.el,h=d.clientHeight,u=d.clientWidth;e.onmousedown=function(d){r.params.kind=i,r.params.flag=!0,d=d||window.event,r.params.currentX=d.clientX,r.params.currentY=d.clientY,e.onselectstart=function(){return!1},document.onmousemove=function(e){var i=e||window.event;if(r.params.flag){var a=i.clientX,o=i.clientY,n=a-r.params.currentX,s=o-r.params.currentY;switch(r.params.kind){case"n":t.style.top=parseInt(r.params.top)+s+"px",t.style.height=parseInt(r.params.height)-s+"px";break;case"w":t.style.left=parseInt(r.params.left)+n+"px",t.style.width=parseInt(r.params.width)-n+"px";break;case"e":t.style.width=parseInt(r.params.width)+n+"px";break;case"s":t.style.height=parseInt(r.params.height)+s+"px";break;case"nw":t.style.left=parseInt(r.params.left)+n+"px",t.style.width=parseInt(r.params.width)-n+"px",t.style.top=parseInt(r.params.top)+s+"px",t.style.height=parseInt(r.params.height)-s+"px";break;case"ne":t.style.top=parseInt(r.params.top)+s+"px",t.style.height=parseInt(r.params.height)-s+"px",t.style.width=parseInt(r.params.width)+n+"px";break;case"sw":t.style.left=parseInt(r.params.left)+n+"px",t.style.width=parseInt(r.params.width)-n+"px",t.style.height=parseInt(r.params.height)+s+"px";break;case"se":t.style.width=parseInt(r.params.width)+n+"px",t.style.height=parseInt(r.params.height)+s+"px";break;default:t.style.left=parseInt(r.params.left)+n+"px",t.style.top=parseInt(r.params.top)+s+"px",parseInt(r.getCss(t,"left"))<=0&&(t.style.left="0px"),parseInt(r.getCss(t,"top"))<=0&&(t.style.top="0px"),parseInt(r.getCss(t,"left"))>=u-r.capture.width&&(t.style.left=u-r.capture.width-2+"px"),parseInt(r.getCss(t,"top"))>=h-r.capture.height&&(t.style.top=h-r.capture.height-2+"px")}}},document.onmouseup=function(){r.params.flag=!1,"auto"!==r.getCss(t,"left")&&(r.params.left=r.getCss(t,"left")),"auto"!==r.getCss(t,"top")&&(r.params.top=r.getCss(t,"top")),r.params.width=r.getCss(t,"width"),r.params.height=r.getCss(t,"height"),p=parseInt(t.style.left),l=parseInt(t.style.top),n=parseInt(t.style.width),s=parseInt(t.style.height),p<0&&(p=0),l<0&&(l=0),p+n>o&&(n=o-p),l+s>a&&(s=a-l),r.capture.x=p,r.capture.y=l,r.capture.width=r.ID("zxxCropBox")&&parseInt(r.ID("zxxCropBox").style.width),r.capture.height=r.ID("zxxCropBox")&&parseInt(r.ID("zxxCropBox").style.height)}}};h(this.ID("zxxDragBg"),this.ID("zxxCropBox"),"drag"),h(this.ID("dragLeftTop"),this.ID("zxxCropBox"),"nw"),h(this.ID("dragLeftBot"),this.ID("zxxCropBox"),"sw"),h(this.ID("dragRightTop"),this.ID("zxxCropBox"),"ne"),h(this.ID("dragRightBot"),this.ID("zxxCropBox"),"se"),h(this.ID("dragTopCenter"),this.ID("zxxCropBox"),"n"),h(this.ID("dragBotCenter"),this.ID("zxxCropBox"),"s"),h(this.ID("dragRightCenter"),this.ID("zxxCropBox"),"e"),h(this.ID("dragLeftCenter"),this.ID("zxxCropBox"),"w")}},{key:"_captureAll",value:function(){this._captureFn({captureAll:!0})}},{key:"_captureFn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{captureAll:!1},t=e.captureAll;this.comfirnCb&&this.comfirnCb();var r=this;if(t)a()(r.el).then((function(e){var t=e.toDataURL("image/png");r.afterCapture?r.afterCapture(t):r._saveFile(t,"capture"+(new Date).getTime()+".png")}));else{var i=this.el,o=i.clientHeight,n=i.clientWidth,s=this.capture,p=s.x,l=s.y,d=s.width,h=s.height;a()(this.el).then((function(e){var t;try{t=e.toDataURL("image/png")}catch(e){if(!r.afterCapture)throw new Error(e.message);r.afterCapture(e.message)}var i=e.height/o,a=e.width/n;p*=a,l*=i,d*=a,h*=i;var s=new Image;s.height=o,s.width=n,s.src=t,s.onload=function(){var e=r._cropImage(s,p,l,d,h);r.afterCapture?(r.afterCapture(null,e),r._cancelCaptureFn()):r._saveFile(e,"capture"+(new Date).getTime()+".png")}})).catch((function(e){if(!r.afterCapture)throw new Error(e.message);r.afterCapture(e.message)}))}}},{key:"_cancelCaptureFn",value:function(){this.capture={x:0,y:0,width:100,height:100},this.oRelDiv.remove(),document.getElementById("captureTool").remove(),this.el.parentElement.style.overflow=this.elOverflow}},{key:"_cropImage",value:function(e,t,r,i,a){var o=document.createElement("canvas");return o.width=i,o.height=a,o.getContext("2d").drawImage(e,t,r,i,a,0,0,i,a),o.toDataURL("image/png")}},{key:"_saveFile",value:function(e,t){var r=document.createElementNS("http://www.w3.org/1999/xhtml","a");r.href=e,r.download=t;var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.dispatchEvent(i),this._cancelCaptureFn()}},{key:"RegisterAfterCapture",value:function(e){this.afterCapture=e}}])&&o(t.prototype,r),i&&o(t,i),e}();t.default=n}]).default}));